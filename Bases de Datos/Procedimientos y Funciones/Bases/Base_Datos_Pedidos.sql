DROP DATABASE IF EXISTS PEDIDOS;
CREATE DATABASE PEDIDOS CHARACTER SET utf8mb4;
USE PEDIDOS;

CREATE TABLE pedido (
  RefPed CHAR(5) PRIMARY KEY,
  FecPed DATE NOT NULL
);

CREATE TABLE articulo (
  CodArt CHAR(5) PRIMARY KEY,
  DesArt VARCHAR(30) NOT NULL,
  PVPArt FLOAT(6,2) UNSIGNED NOT NULL
);

CREATE TABLE LineaPedido (
  RefPed CHAR(5),
  CodArt CHAR(5),
  CantArt INT(4) UNSIGNED NOT NULL DEFAULT 1,
  INDEX (RefPed),
  FOREIGN KEY (RefPed) REFERENCES pedido(RefPed)
  ON UPDATE CASCADE,
  INDEX (CodArt),
  FOREIGN KEY (CodArt) REFERENCES articulo(CodArt)
  ON UPDATE CASCADE,
  PRIMARY KEY (RefPed, CodArt)
);

INSERT INTO pedido VALUES ('P0001', '2014-02-16');
INSERT INTO pedido VALUES ('P0002', '2014-02-18');
INSERT INTO pedido VALUES ('P0003', '2014-02-23');
INSERT INTO pedido VALUES ('P0004', '2014-02-25');

INSERT INTO articulo VALUES ('A0043', 'Bolígrafo azul', 0.78);
INSERT INTO articulo VALUES ('A0078', 'Bolígrafo rojo normal', 1.05);
INSERT INTO articulo VALUES ('A0075', 'Lápiz 2B', 0.55);
INSERT INTO articulo VALUES ('A0012', 'Goma de borrar', 0.15);
INSERT INTO articulo VALUES ('A0089', 'Sacapuntas', 0.25);

INSERT INTO LineaPedido VALUES ('P0001', 'A0043', 10);
INSERT INTO LineaPedido VALUES ('P0001', 'A0078', 12);
INSERT INTO LineaPedido VALUES ('P0002', 'A0043', 5);
INSERT INTO LineaPedido VALUES ('P0003', 'A0075', 20);
INSERT INTO LineaPedido VALUES ('P0004', 'A0012', 15);
INSERT INTO LineaPedido VALUES ('P0004', 'A0043', 5);
INSERT INTO LineaPedido VALUES ('P0004', 'A0089', 50);